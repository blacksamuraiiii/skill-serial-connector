# skill-serial-connector

[![Version](https://img.shields.io/badge/version-v0.1-blue.svg)](https://github.com/blacksamuraiiii/skill-serial-connector)
[![Platform](https://img.shields.io/badge/platform-win10--x64-orange.svg)](https://github.com/blacksamuraiiii/skill-serial-connector)

`skill-serial-connector` æ˜¯ä¸€ä¸ªä¸“ä¸º Windows ç¯å¢ƒè®¾è®¡çš„äº¤æ¢æœºä¸²å£è‡ªåŠ¨åŒ–å·¥å…·ã€‚å®ƒä¸ä»…æ˜¯ä¸€ä¸ªç‹¬ç«‹çš„ Python åº“ï¼Œæ›´æ˜¯ä¸€ä¸ªå®Œå…¨ç¬¦åˆ **Claude Code Agent SKILL** è§„èŒƒçš„æ™ºèƒ½æ’ä»¶ã€‚é€šè¿‡é›†æˆ `plink.exe`ï¼Œå®ƒèƒ½å¤Ÿè®© AI åŠ©æ‰‹ç›´æ¥æ¥ç®¡ä¸²å£ï¼Œå®ç°å¯¹ä¸­å…´ã€åä¸ºã€æ€ç§‘ç­‰ä¸»æµå‚å•†è®¾å¤‡çš„åè®®æ‰«æã€é…ç½®ä¸‹å‘åŠæ•…éšœæ’æŸ¥ã€‚

---

## ğŸ¤– AI Agent å…¼å®¹æ€§

æœ¬é¡¹ç›®ä¸¥æ ¼éµå¾ª **Agent Skills å¼€æºæ ‡å‡†**ï¼Œå¯æ— ç¼é›†æˆè‡³ Claude Codeã€Cursor ç­‰ä¸»æµ AI ç¼–ç¨‹åŠ©æ‰‹ï¼š

- **è‡ªåŠ¨åŒ–æŒ‡ä»¤è½¬æ¢**ï¼šAI åŠ©æ‰‹å¯é˜…è¯» `references/` ä¸‹çš„å‚å•†æ‰‹å†Œï¼Œè‡ªåŠ¨å°†è‡ªç„¶è¯­è¨€ï¼ˆå¦‚â€œæŠŠ gei-2/1 æ¢åˆ° VLAN 10â€ï¼‰è½¬æ¢ä¸ºå¯¹åº”å‚å•†çš„ CLI å‘½ä»¤ã€‚
- **è‡ªæè¿°è°ƒç”¨ç•Œé¢**ï¼šé€šè¿‡ `SKILL.md` å®šä¹‰çš„ä»»åŠ¡åè®®ï¼ŒAI åŠ©æ‰‹èƒ½è‡ªä¸»å†³å®šä½•æ—¶è°ƒç”¨ `serial_connector.py` è¿›è¡Œç‰©ç†äº¤äº’ã€‚
- **çŠ¶æ€æ„ŸçŸ¥æ‰§è¡Œ**ï¼šAI èƒ½é€šè¿‡è¯»å– `.log` æ–‡ä»¶å®æ—¶æ„ŸçŸ¥è®¾å¤‡åé¦ˆï¼Œå¹¶æ ¹æ®é”™è¯¯æç¤ºï¼ˆå¦‚ `Error 140303`ï¼‰è‡ªåŠ¨ä¿®æ­£å‘½ä»¤é€»è¾‘ã€‚
- **æ— æ„Ÿæ–­ç‚¹ç»­ä¼ **ï¼šå½“ AI ä»»åŠ¡å›  Token é™åˆ¶æˆ–ç½‘ç»œæ³¢åŠ¨ä¸­æ–­æ—¶ï¼Œæ–°çš„ Agent å®ä¾‹èƒ½é€šè¿‡æ—¥å¿—è‡ªåŠ¨å®šä½è¿›åº¦ï¼Œå®ç°æ— ç¼æ¥åŠ›ã€‚

---

## âœ¨ æ ¸å¿ƒåŠŸèƒ½

- **ğŸš€ è‡ªåŠ¨åŒ–ä»»åŠ¡ç®¡ç†**ï¼šé€šè¿‡ API å¿«é€Ÿç”Ÿæˆä»»åŠ¡æ–‡ä»¶ï¼ˆ`.txt`ï¼‰å¹¶æ‰§è¡Œã€‚
- **â±ï¸ ç»Ÿä¸€å‘½åè§„èŒƒ**ï¼šä»»åŠ¡æ–‡ä»¶ä¸æ—¥å¿—æ–‡ä»¶å…±äº«ç›¸åŒçš„æ—¶é—´æˆ³ï¼ˆ`{å‚å®¶}_{æ—¶é—´æˆ³}`ï¼‰ï¼Œä¾¿äºå›æº¯ã€‚
- **ğŸ”„ æ–­ç‚¹ç»­ä¼ æœºåˆ¶**ï¼šè‡ªåŠ¨åˆ†æå·²æ‰§è¡Œæ—¥å¿—ï¼Œæ”¯æŒåœ¨å¼‚å¸¸ä¸­æ–­åä»æœ€åä¸€æ¡æˆåŠŸå‘½ä»¤ç»§ç»­æ‰§è¡Œã€‚
- **ğŸ›¡ï¸ Windows æ·±åº¦ä¼˜åŒ–**ï¼š
  - é’ˆå¯¹ Windows å¤„ç†ä¸²å£è¾“å…¥æµçš„ç‰¹æ€§ï¼Œä¿®å¤äº† `OSError [Errno 22] Invalid argument` é”™è¯¯ã€‚
  - ä½¿ç”¨ `\n` æ›¿ä»£ `\r` æé«˜ä¸åŒå‚å•†è®¾å¤‡çš„å…¼å®¹æ€§ã€‚
- **ğŸ§¹ ç›®å½•åˆ†ç¦»æ¶æ„**ï¼šSKILL æ ¸å¿ƒæ–‡ä»¶ä¸è¿è¡Œç”Ÿæˆçš„ä¸´æ—¶æ–‡ä»¶å®Œå…¨åˆ†ç¦»ï¼Œä¿æŒé¡¹ç›®ç›®å½•çº¯å‡€ã€‚
- **ğŸ“š å¤šå‚å•†é¢„è®¾**ï¼šå†…ç½®ä¸­å…´ (ZTE)ã€åä¸º (HW)ã€H3Cã€é”æ· (Ruijie)ã€æ€ç§‘ (Cisco) çš„å¸¸ç”¨æŒ‡ä»¤å‚è€ƒã€‚

---

## ğŸ’» ç³»ç»Ÿè¦æ±‚

- **æ“ä½œç³»ç»Ÿ**ï¼šWindows 10 / 11 x64
- **è¿è¡Œç¯å¢ƒ**ï¼šPython 3.8+
- **ä¾èµ–å·¥å…·**ï¼š`assets/plink.exe` (å·²å†…ç½®)

---

## ğŸ› ï¸ è°ƒç”¨æµç¨‹

```mermaid
graph TD
    A[å¼€å§‹] --> B[å‡†å¤‡å‘½ä»¤åˆ—è¡¨ commands]
    B --> C[è°ƒç”¨ create_task_file ç”Ÿæˆä»»åŠ¡æ–‡ä»¶]
    C --> D{æ˜¯å¦ä»ä¸­æ–­å¤„ç»§ç»­?}
    D -- æ˜¯ --> E[è°ƒç”¨ execute_task_file resume=True]
    D -- å¦ --> F[è°ƒç”¨ execute_task_file resume=False]
    E --> G[åˆ†ææ—¥å¿—è¿›åº¦]
    F --> H[ä»ç¬¬ä¸€æ¡å¼€å§‹æ‰§è¡Œ]
    G --> I[é€æ¡å‘é€å‘½ä»¤è‡³ä¸²å£]
    H --> I
    I --> J[è®°å½•å®æ—¶æ—¥å¿— .log]
    J --> K{æ‰€æœ‰å‘½ä»¤æ‰§è¡Œå®Œ?}
    K -- å¦ --> I
    K -- æ˜¯ --> L[ç”Ÿæˆæ‰§è¡Œæ‘˜è¦]
    L --> M[ç»“æŸ]
```

---

## ğŸš€ å¿«é€Ÿå¼€å§‹

### 1. è‡ªåŠ¨ç”Ÿæˆå¹¶æ‰§è¡Œï¼ˆæ¨èï¼‰

è¿™æ˜¯æœ€ç®€å•çš„è°ƒç”¨æ–¹å¼ï¼Œåªéœ€å‡†å¤‡å¥½å‚å•†ã€ç«¯å£ã€å¯†ç å’Œå‘½ä»¤åˆ—è¡¨ï¼š

```python
from scripts.serial_connector import create_task_file, execute_task_file

# 1. å®šä¹‰é…ç½®
commands = [
    "enable",
    "configure terminal",
    "interface gei-2/1",
    "switchport mode access",
    "switchport access vlan 10",
    "exit"
]

# 2. åˆ›å»ºä»»åŠ¡æ–‡ä»¶ï¼ˆä¼šè‡ªåŠ¨ç”Ÿæˆå¸¦æ—¶é—´æˆ³çš„æ–‡ä»¶ï¼Œå¦‚ ZTE_20260129_190900.txtï¼‰
task_file, log_file = create_task_file(
    vendor="ZTE",
    com_port="COM6",
    baud_rate=115200,
    password="your_password",
    commands=commands,
    output_dir="." # è¾“å‡ºåˆ°å½“å‰ç›®å½•
)

# 3. æ‰§è¡Œä»»åŠ¡
result = execute_task_file(task_file, resume=True)

if result.get("status") == "success":
    print(f"æ‰§è¡ŒæˆåŠŸï¼æ—¥å¿—ä¿å­˜åœ¨: {result['log_file']}")
```

### 2. ä»»åŠ¡æ–‡ä»¶æ ¼å¼

ä½ ä¹Ÿå¯ä»¥æ‰‹åŠ¨åˆ›å»ºä»»åŠ¡æ–‡ä»¶æ‰§è¡Œï¼š

```ini
[METADATA]
vendor=ZTE
com_port=COM6
baud_rate=115200
password=admin
log_file=ZTE_20260129_193000.log

[COMMANDS]
show version
show interface brief

[END]
```

---

## ğŸ“ æ–‡ä»¶ç»“æ„

```text
skill-serial-connector/
â”œâ”€â”€ SKILL.md                    # è¯¦ç»†æŠ€æœ¯è§„æ ¼æ–‡æ¡£
â”œâ”€â”€ task_template.txt           # ä»»åŠ¡æ–‡ä»¶æ ‡å‡†æ¨¡æ¿
â”œâ”€â”€ scripts/
â”‚   â””â”€â”€ serial_connector.py     # æ ¸å¿ƒ Python é€»è¾‘ (v0.1)
â”œâ”€â”€ assets/
â”‚   â””â”€â”€ plink.exe              # ä¸²å£é€šä¿¡æ ¸å¿ƒç»„ä»¶
â”œâ”€â”€ references/                 # å‚å•†æŒ‡ä»¤å‚è€ƒæ‰‹å†Œ
â”‚   â”œâ”€â”€ zte-commands.md
â”‚   â”œâ”€â”€ hw-commands.md
â”‚   â”œâ”€â”€ h3c-commands.md
â”‚   â”œâ”€â”€ ruijie-commands.md
â”‚   â””â”€â”€ cisco-commands.md
â””â”€â”€ (ç”Ÿæˆçš„ä¸´æ—¶æ–‡ä»¶)             # è¿è¡Œåå‡ºç°åœ¨å·¥ä½œç›®å½•ï¼Œä¸å½±å“ä»¥ä¸Šç»“æ„
    â”œâ”€â”€ ZTE_20260129_190900.txt
    â””â”€â”€ ZTE_20260129_190900.log
```

---

## âŒ é”™è¯¯è¯´æ˜ä¸æ’æŸ¥

| é”™è¯¯ç‰¹å¾                        | å¯èƒ½åŸå›                | è§£å†³æ–¹æ³•                                                                 |
| :------------------------------ | :--------------------- | :----------------------------------------------------------------------- |
| **Error 140303**          | æ¨¡å¼é”™è¯¯æˆ–è¯­æ³•é”™è¯¯     | ç¡®è®¤æ˜¯å¦å·²æ‰§è¡Œ `enable` è¿›å…¥ç‰¹æƒæ¨¡å¼æˆ– `config t` è¿›å…¥é…ç½®æ¨¡å¼ã€‚     |
| **Error 140251**          | å¯†ç è¾“å…¥è¶…æ—¶           | æ£€æŸ¥å¯†ç æ˜¯å¦æ­£ç¡®ï¼Œæˆ–å¢åŠ  `wait_time` å»¶è¿Ÿã€‚                            |
| **OSError [Errno 22]**    | Windows è¿›ç¨‹ç®¡é“å¼‚å¸¸   | `v0.1å·²ä¿®å¤`ã€‚ç¡®ä¿ä½¿ç”¨æœ€æ–°è„šæœ¬ï¼Œä¼šè‡ªåŠ¨æ£€æŸ¥è¿›ç¨‹çŠ¶æ€å¹¶ä½¿ç”¨ `\n` æ¢è¡Œã€‚ |
| **Timeout / No Response** | ä¸²å£å ç”¨æˆ–å‚æ•°é…ç½®é”™è¯¯ | æ£€æŸ¥ COM å£å·æ˜¯å¦è¢«å…¶ä»–è½¯ä»¶ï¼ˆå¦‚ Puttyï¼‰å ç”¨ï¼›ç¡®è®¤æ³¢ç‰¹ç‡ï¼ˆé»˜è®¤ 115200ï¼‰ã€‚ |

---

## âš ï¸ å¼€å‘æ³¨æ„äº‹é¡¹

1. **å‘½ä»¤é¡ºåº**ï¼šäº¤æ¢æœºé€šå¸¸æœ‰ä¸¥æ ¼çš„æ¨¡å¼å±‚çº§ï¼ˆç”¨æˆ·æ¨¡å¼ -> ç‰¹æƒæ¨¡å¼ -> å…¨å±€é…ç½®æ¨¡å¼ï¼‰ã€‚åœ¨ `commands` åˆ—è¡¨ä¸­å¿…é¡»åŒ…å« `enable` æˆ– `configure terminal` ç­‰åˆ‡æ¢æŒ‡ä»¤ã€‚
2. **è¿æ¥å ç”¨**ï¼šæœ¬å·¥å…·è¿è¡ŒæœŸé—´ä¼šç‹¬å ä¸²å£ï¼Œè¯·å…³é—­ç¬¬ä¸‰æ–¹ä¸²å£è°ƒè¯•åŠ©æ‰‹ã€‚
3. **å®‰å…¨æç¤º**ï¼šè¯·å‹¿åœ¨ `password` å­—æ®µä¸­ç¡¬ç¼–ç æ•æ„Ÿç”Ÿäº§å¯†ç ï¼Œå»ºè®®ä½¿ç”¨ç¯å¢ƒå˜é‡æˆ–è¾“å…¥æç¤ºã€‚

---

## ğŸ”— é¡¹ç›®é“¾æ¥

- **GitHub**: [blacksamuraiiii/skill-serial-connector](https://github.com/blacksamuraiiii/skill-serial-connector)
- **License**: MIT

---

*Last Updated: 2026-01-29*
